{% extends 'base.html' %}
{% load static %}
{% block title %}TaskManagement{% endblock %}
{% block content %}
<div class="layout">
  <!-- Main Content -->
  <div class="main-content">
    <div class="top-bar">
      <h1>Task Management (Admin)</h1>
      <a href="{% url 'board' %}" class="back-button">‚Üê Back</a>
    </div>

    <h2>Add Task</h2>
    <form method="post" class="fade-in">
      {% csrf_token %}
      {{ form.as_p }}
      <button type="submit">+ Add Task</button>
    </form>

    <h2>All Tasks</h2>
    <table class="fade-in">
      <tr>
        <th>Title</th>
        <th>Description</th>
        <th>Assigned To</th>
        <th>Deadline</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
      {% for task in tasks %}
        <tr>
          <td>{{ task.title }}</td>
          <td>{{ task.description }}</td>
          <td>{{ task.assigned_to }}</td>
          <td>{{ task.deadline }}</td>
          <td>{{ task.get_status_display }}</td>
          <td class="actions">
            <a href="{% url 'edit_task' task.pk %}">Edit</a>
            <a href="{% url 'delete_task' task.pk %}" class="delete-link">Delete</a>
          </td>
        </tr>
      {% empty %}
        <tr class="empty-row"><td colspan="6">No tasks</td></tr>
      {% endfor %}
    </table>
  </div>
</div>

<script>
  // Fade in table rows
  document.querySelectorAll("table tr").forEach((row, i) => {
    setTimeout(() => row.classList.add("fade-in"), i * 80);
  });

  // Persistent Dark Mode
  const body = document.body;
  const darkModeBtn = document.querySelector('.dark-mode-btn');
  if(localStorage.getItem('darkMode') === 'true') body.classList.add('dark-mode');
  darkModeBtn.addEventListener('click', () => {
    body.classList.toggle('dark-mode');
    localStorage.setItem('darkMode', body.classList.contains('dark-mode'));
  });
</script>

{% endblock %}
